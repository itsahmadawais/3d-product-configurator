var events=function(){var events={};function on(eventName,fn){events[eventName]=events[eventName]||[],events[eventName].push(fn)}function off(eventName,fn){if(events[eventName])for(var i=0;i<events[eventName].length;i++)if(events[eventName][i]===fn){events[eventName].splice(i,1);break}}function emit(eventName,data){events[eventName]&&events[eventName].forEach((function(fn){fn(data)}))}return{on:on,off:off,emit:emit}}();window.$=window.jQuery=jQuery;var rcPlayer=function(){var $rcPlayerWrapper=$("#wc-3d-wrapper"),$fullScreenToggle=$(".fullscreen_toggle"),$playToggle=$(".play_pause_toggle"),$saveButton=$(".save_image"),strDownloadMime="image/octet-stream",product_title=$("h1.product_title").html();$fullScreenToggle.addClass("nofullscreen"),$playToggle.addClass("play");var originalW=$rcPlayerWrapper.width(),originalH=$rcPlayerWrapper.height(),$wc_3d_materials=$(".wc_3d_materials"),canvas=$("#wc_3d"),controls,renderer;function setControls(data){controls=data}function setRenderer(data){renderer=data}function rcScreenToggle(){$fullScreenToggle.hasClass("nofullscreen")?($fullScreenToggle.removeClass("nofullscreen"),$fullScreenToggle.removeClass("fa-compress"),$fullScreenToggle.addClass("fa-compress-arrows-alt"),$fullScreenToggle.addClass("fullscreen"),$rcPlayerWrapper.addClass("fullscreenmode"),$rcPlayerWrapper.width($(window).width()-20),$rcPlayerWrapper.height($(window).height()),$wc_3d_materials.width($wc_3d_materials.width()),$wc_3d_materials.height($wc_3d_materials.height()),$wc_3d_materials.addClass("fullscreenmode")):($fullScreenToggle.removeClass("fullscreen"),$fullScreenToggle.addClass("nofullscreen"),$fullScreenToggle.addClass("fa-compress"),$fullScreenToggle.removeClass("fa-compress-arrows-alt"),$rcPlayerWrapper.removeClass("fullscreenmode"),$rcPlayerWrapper.width(originalW),$rcPlayerWrapper.height(originalH),$wc_3d_materials.width($wc_3d_materials.width()),$wc_3d_materials.height($wc_3d_materials.height()),$wc_3d_materials.removeClass("fullscreenmode")),rcWindowResize.onWindowResize($rcPlayerWrapper)}function playPauseToggle(){$playToggle.hasClass("play")?($playToggle.removeClass("play"),$playToggle.addClass("pause"),controls.autoRotate=!0):($playToggle.removeClass("pause"),$playToggle.addClass("play"),controls.autoRotate=!1)}function rcSaveCanvas(){var imgData,imgNode;try{var strMime="image/jpeg";imgData=renderer.domElement.toDataURL(strMime),saveFile(imgData.replace(strMime,strDownloadMime),product_title+".jpg")}catch(e){return}}events.on("getControls",setControls),events.on("renderedLoaded",setRenderer),$fullScreenToggle.on("click",rcScreenToggle),$playToggle.on("click",playPauseToggle),$saveButton.on("click",rcSaveCanvas)}(),wc_3d_product_Get_data=function(){var productID=$("#productId").val();if(null==productID){var id,matches=document.body.className.match(/(^|\s)postid-(\d+)(\s|$)/);matches&&(productID=matches[2])}var action="wc_rc_getproductdata";return jQuery.ajax({type:"POST",url:wc3dProductJs.ajaxUrl,data:{action:action,productID:productID},success:function(data){}})}();wc_3d_product_Get_data.success((function(data){events.emit("ajaxDataReceived",data)}));var wcRcSceneBuilder=function(data){var scene,renderer,camera,mainObj,controls,stats,wc_3d_debug_activate,wc_3d_product_data,obj_position,obj_pos_array;Detector.webgl||Detector.addGetWebGLMessage();var canvas=document.getElementById("wc_3d"),parent=canvas.parentNode;function startInit(data){wc_3d_product_data=jQuery.parseJSON(data),"on"==(wc_3d_debug_activate=wc_3d_product_data.wc_3d_debug_activate)&&(stats=new Stats,parent.appendChild(stats.dom)),obj_position=wc_3d_product_data.obj_position,obj_pos_array=obj_position.split(","),(renderer=new THREE.WebGLRenderer({canvas:canvas,alpha:!0,antialias:!0,preserveDrawingBuffer:!0})).setPixelRatio(window.devicePixelRatio),renderer.setSize(parent.offsetWidth,parent.offsetHeight),renderer.shadowMap.enabled=!0,renderer.shadowMapSoft=!0,renderer.shadowMap.type=THREE.PCFShadowMap;var canvas_bg=wc_3d_product_data.canvas_bg,canvas_transparant=wc_3d_product_data.canvas_transparant;scene=new THREE.Scene,"on"==canvas_transparant||(scene.background=""!=canvas_bg?new THREE.Color(canvas_bg):new THREE.Color(13421772)),rcCamera(),rcLights(),rcCustomLights(),rcEnvMap(),rcLoader(),rcShadowPlan(),rcControls(),animate(),events.emit("renderedLoaded",renderer),events.emit("getCamera",camera),events.emit("getControls",controls)}function rcEnvMap(){var env_map=wc_3d_product_data.env_map,env_bg=wc_3d_product_data.env_bg;""!=env_map&&(new THREE.RGBELoader).setDataType(THREE.UnsignedByteType).load(env_map,(function(texture){const pmremGenerator=new THREE.PMREMGenerator(renderer);var envMap=pmremGenerator.fromEquirectangular(texture).texture;"on"==env_bg&&(scene.background=envMap),scene.environment=envMap,texture.dispose(),pmremGenerator.dispose()}))}function rcCamera(){camera=new THREE.PerspectiveCamera(45,parent.offsetWidth/parent.offsetHeight,.1,2e3);var camera_position=wc_3d_product_data.camera_position;if(camera_position){var camera_pos_array=camera_position.split(",");camera.position.set(camera_pos_array[0],camera_pos_array[1],camera_pos_array[2])}else camera.position.set(50,200,180);var camera_rotation=wc_3d_product_data.camera_rotation;if(camera_rotation){var camera_rot_array=camera_rotation.split(",");camera.rotation.set(camera_rot_array[0],camera_rot_array[1],camera_rot_array[2])}else camera.rotation.set(0,0,45)}function rcLights(){var cast_shadow_option=wc3dProductJs.cast_shadow,disable_lights;if("on"==wc_3d_product_data.disable_lights);else{if(hemiLight=new THREE.HemisphereLight(16777215,15658734,.6),hemiLight.position.set(0,200,0),scene.add(hemiLight),dirLight=new THREE.DirectionalLight(16777215,.4),dirLight.position.set(-35,175,190),"yes"==cast_shadow_option){dirLight.castShadow=!0;const d=100;dirLight.shadow.camera.left=-d,dirLight.shadow.camera.right=d,dirLight.shadow.camera.top=d,dirLight.shadow.camera.bottom=-d,dirLight.shadow.mapSize.width=4096,dirLight.shadow.mapSize.height=4096}camera.add(dirLight),scene.add(camera)}}function rcCustomLights(){var lights=wc_3d_product_data.lights;"-1"!=jQuery.isArray(lights)&&""!=lights&&lights.forEach((function(element,i){var light_json=element,light_type=light_json.light_type,light_intensity=light_json.light_intensity;light_intensity||(light_intensity=1);var light_color=light_json.light_color;light_color||(light_color="#ffffff");var light_location=light_json.light_location;light_location||(light_location="0, 0, 0");var light_location_array=light_location.split(","),light_shadow=light_json.light_shadow,light_new;if(light_shadow||(light_shadow="no"),"point"==light_type)(light_new=new THREE.PointLight(light_color,light_intensity)).position.set(light_location_array[0],light_location_array[1],light_location_array[2]),"yes"==light_shadow&&(light_new.castShadow=!0),scene.add(light_new);else if("directional"==light_type){var light_new;(light_new=new THREE.DirectionalLight(light_color,light_intensity)).position.set(light_location_array[0],light_location_array[1],light_location_array[2]),"yes"==light_shadow&&(light_new.castShadow=!0),scene.add(light_new)}else if("ambient"==light_type){var light_new=new THREE.AmbientLight(light_color,light_intensity);scene.add(light_new)}}))}function rcLoader(){var obj_type=wc_3d_product_data.wc_3d_object_type;wc_3d_loader(wc_3d_product_data.obj_file,obj_type)}function setModelData(data){scene.remove(mainObj),addModeltoScene(mainObj=data)}function addModeltoScene(mainObj){mainObj.traverse((function(child){child.isMesh&&(child.castShadow=!0)})),obj_position?mainObj.position.set(obj_pos_array[0],obj_pos_array[1],obj_pos_array[2]):mainObj.position.set(0,-40,0),scene.add(mainObj),camera.lookAt(mainObj.position)}function rcShadowPlan(){var shadowMat=new THREE.ShadowMaterial;shadowMat.opacity=.2;var plan=new THREE.PlaneBufferGeometry(500,500,100,100),shadowplan=new THREE.Mesh(plan,shadowMat);shadowplan.position.y=obj_position?obj_pos_array[1]:-40,shadowplan.rotation.x=-Math.PI/2,shadowplan.receiveShadow=!0}function rcControls(){var allow_downside=wc3dProductJs.allow_downside;(controls=new THREE.OrbitControls(camera,canvas)).enablePan=!1,controls.enableZoom=!0,""!=wc_3d_product_data.camera_zoom_min&&(controls.minDistance=wc_3d_product_data.camera_zoom_min),""!=wc_3d_product_data.camera_zoom_max&&(controls.maxDistance=wc_3d_product_data.camera_zoom_max),"no"==allow_downside&&(controls.maxPolarAngle=Math.PI/2)}function animate(){requestAnimationFrame(animate),controls.update(),render(),"on"==wc_3d_debug_activate&&stats.update()}function render(){renderer.render(scene,camera)}events.on("ajaxDataReceived",startInit),events.on("modelLoaded",setModelData)}(),rcWindowResize=function(){var camera,renderer;function setCamera(data){camera=data}function setRenderer(data){renderer=data}function onWindowResize(parent){renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(parent.width(),parent.height()),camera.fov=45,camera.aspect=parent.width()/parent.height(),camera.updateProjectionMatrix()}return events.on("getCamera",setCamera),events.on("renderedLoaded",setRenderer),{onWindowResize:onWindowResize}}(),initialObjectShowHide=function(){events.on("modelLoaded",initialObjectShow);var object_initial_data=$(".object_initial_data");function initialObjectShow(mainObj){mainObj.traverse((function(child){$(object_initial_data).each((function(){var currentElement=$(this),hide_objs=currentElement.attr("data-hide");hideobjsArray=hide_objs.split(", "),jQuery.each(hideobjsArray,(function(i,val){child.name==val&&(child.visible=!1)}));var show_obj=currentElement.attr("data-show");child.name==show_obj&&(child.visible=!0)}))}))}}(),addFontsToSvg=function(){function checkSvgData(data){var wc_3d_product_data,svg_active;if("on"==jQuery.parseJSON(data).svg_active){var svg=document.getElementById("svg_data").querySelector("svg"),html='<defs><style id="fontimport" type="text/css"></style></defs>';$(svg).prepend(html);var allFontsFiles=$(".fontFamily"),svgfont=document.getElementById("fontimport");jQuery.each(allFontsFiles,(function(i,val){var fontCss=$(val).attr("data-font-url");$.get(fontCss,(function(data){$(svgfont).append(data)}))}))}}events.on("ajaxDataReceived",checkSvgData)}(),materialConfig=function(){var svg_active,mainModel,use_price_option=wc3dProductJs.use_price;function SvgActive(data){var wc_3d_product_data=jQuery.parseJSON(data);svg_active=wc_3d_product_data.svg_active}function setModel(mainObj){mainModel=mainObj}function materialChanged(){var element=$(this),material_options=element.closest(".material_options");material_options.find(".mat_option").removeClass("active"),element.addClass("active");var mat_id,matArray=element.attr("data-mat").split(", "),mat_color=element.attr("data-mat-color"),mat_map=element.attr("data-mat-map"),mat_title=element.attr("data-mat-title");if("yes"==use_price_option){var mat_price=element.attr("data-mat-price");mat_price||(mat_price=0),material_options.siblings(".wc_mat_price").val(mat_price),material_heading=material_options.siblings("h3"),material_heading.children(".option_price").html("<b>+ "+mat_price+"</b>"),rcCalculateTotal.wc3dcalulatePrice()}material_options.siblings(".mat_value").val(mat_title);var $special_material=document.getElementById("svg_data");if($special_material){var special_material_name=$special_material.getAttribute("data-svgM");""!=special_material_name&&("-1"!=jQuery.inArray(special_material_name,matArray)?svg_active="on":jQuery.each(matArray,(function(i,val){var svg_path=$special_material.querySelector("#".val);svg_active=""!=svg_path?"on":"off"})))}"on"==svg_active?(jQuery.each(matArray,(function(i,val){if(-1!=val.indexOf("*")){var wild_ids=val.replace("*","");$("[id^='"+wild_ids+"']").attr("class",""),$("[id^='"+wild_ids+"']").each((function(){var parentTag;"linearGradient"==$(this).parent().get(0).tagName?$(this).css("stop-color",mat_color):$(this).attr("fill",mat_color)}))}else{var svg_path;document.getElementById(val).setAttribute("fill",mat_color)}})),addSvgToModel.applySvgGraphics()):mainModel.traverse((function(child){if(child.isMesh)if(jQuery.isArray(child.material))for(var mat of child.material)"-1"!=jQuery.inArray(mat.name,matArray)&&(mat_map?(texture=(new THREE.TextureLoader).load(mat_map),texture.wrapS=THREE.RepeatWrapping,texture.wrapT=THREE.RepeatWrapping,mat.color.set("#ffffff"),mat.map=texture,mat.needsUpdate=!0):mat.color.set(mat_color));else{var mat=child.material;"-1"!=jQuery.inArray(mat.name,matArray)&&(mat_map?(texture=(new THREE.TextureLoader).load(mat_map),texture.wrapS=THREE.RepeatWrapping,texture.wrapT=THREE.RepeatWrapping,mat.color.set("#ffffff"),mat.map=texture,mat.needsUpdate=!0):mat.color.set(mat_color))}}))}events.on("modelLoaded",setModel),events.on("ajaxDataReceived",SvgActive),$(".mat_option").on("click",materialChanged)}(),fabricgalleryConfig=function(){var svg_active,mainModel,use_price_option=wc3dProductJs.use_price;function SvgActive(data){var wc_3d_product_data=jQuery.parseJSON(data);svg_active=wc_3d_product_data.svg_active}function setModel(mainObj){mainModel=mainObj}function materialChanged(){var element=$(this),mat_id,matArray=element.attr("data-mat").split(", "),mat_color=element.attr("data-mat-color"),mat_map=element.attr("data-mat-map"),mat_title=element.attr("data-mat-title");mainModel.traverse((function(child){if(child.isMesh)if(jQuery.isArray(child.material))for(var mat of child.material)"-1"!=jQuery.inArray(mat.name,matArray)&&(mat_map?(texture=(new THREE.TextureLoader).load(mat_map),texture.wrapS=THREE.RepeatWrapping,texture.wrapT=THREE.RepeatWrapping,mat.color.set("#ffffff"),mat.map=texture,mat.needsUpdate=!0):mat.color.set(mat_color));else{var mat=child.material;"-1"!=jQuery.inArray(mat.name,matArray)&&(mat_map?(texture=(new THREE.TextureLoader).load(mat_map),texture.wrapS=THREE.RepeatWrapping,texture.wrapT=THREE.RepeatWrapping,mat.color.set("#ffffff"),mat.map=texture,mat.needsUpdate=!0):mat.color.set(mat_color))}}))}events.on("modelLoaded",setModel),events.on("ajaxDataReceived",SvgActive),$(document).on("click",".mat_option_fabric_gallery",materialChanged)}(),imageConfig=function(){function adminImageChanged(){var element=$(this);element.addClass("active").siblings().removeClass("active");var img_id=element.attr("data-mat"),mat_map=element.attr("data-mat-map"),mat_title=element.attr("data-mat-title"),material_options;element.parent(".material_options").siblings(".mat_value").val(mat_title);var img_block=document.getElementById(img_id);toDataUrl(mat_map,(function(myBase64){$(img_block).attr("xlink:href",myBase64),addSvgToModel.applySvgGraphics()}))}function userImageChanged(){var element=$(this);element.addClass("active").parent().siblings().removeClass("active");var img_id=element.parent().attr("data-mat"),mat_map=element.children(".dz-image").children("img").attr("src"),mat_title=element.attr("data-attachment"),material_options;element.parent(".material_options").siblings(".mat_value").val(mat_title);var img_block=document.getElementById(img_id);$(img_block).attr("xlink:href",mat_map),addSvgToModel.applySvgGraphics()}$(".img_option").bind("click",adminImageChanged),$(document).on("click",".user_image",userImageChanged)}(),objectConfig=function(){var mainModel;function setModel(mainObj){mainModel=mainObj}function objectChanged(){var element=$(this);element.addClass("active").siblings().removeClass("active");var mat_title=element.attr("data-mat-title"),hide_objs,hideobjsArray=element.siblings(".object_initial_data").attr("data-hide").split(", "),show_obj=element.attr("data-obj-name").split(", "),material_options;mainModel.traverse((function(child){jQuery.each(hideobjsArray,(function(i,val){child.name==val&&(child.visible=!1)})),console.log(show_obj),show_obj.includes(child.name)&&(child.visible=!0)})),element.parent(".material_options").siblings(".mat_value").val(mat_title)}$(".obj_option").bind("click",objectChanged),events.on("modelLoaded",setModel)}(),gradientConfig=function(){function gradientChanged(){var element=$(this);element.addClass("active").siblings().removeClass("active");var mat_id,matArray=element.attr("data-mat").split(", "),mat_color=element.attr("data-mat-color"),mat_title=element.attr("data-mat-title"),material_options=element.parents(".material_options"),gcurvalue=material_options.siblings(".mat_value").val();gcurvalue=gcurvalue.split("-"),jQuery.each(matArray,(function(i,val){var svg_path=document.getElementById(val);$(element).hasClass("gcolor1")?($(svg_path).children(":first-child").css("stop-color",mat_color),""==gcurvalue[1]&&(gcurvalue[1]="Default"),material_options.siblings(".mat_value").val(mat_title+"-"+gcurvalue[1])):$(element).hasClass("gcolor2")&&($(svg_path).children(":last-child").css("stop-color",mat_color),""==gcurvalue[0]&&(gcurvalue[0]="Default"),material_options.siblings(".mat_value").val(gcurvalue[0]+"-"+mat_title))})),addSvgToModel.applySvgGraphics()}$(".gradient_option").bind("click",gradientChanged)}(),patternConfig=function(){function patternChanged(){var element=$(this);element.addClass("active").siblings().removeClass("active");var mat_id,matArray=element.attr("data-mat").split(", "),pattern_id=element.attr("data-pattern-id"),mat_map=element.attr("data-pattern-code"),mat_title=element.attr("data-mat-title"),material_options;element.parent(".material_options").siblings(".mat_value").val(mat_title),jQuery.each(matArray,(function(i,val){var svg_path;document.getElementById(val).setAttribute("fill","url(#"+pattern_id+")")})),addSvgToModel.applySvgGraphics()}$(".pattern_option").bind("click",patternChanged)}(),textConfig=function(){function textInput(){var element=$(this),text_id=element.attr("data-text-id"),update_text=element.val(),textArray=text_id.split(", "),material_options;jQuery.each(textArray,(function(i,val){var text_block=document.getElementById(val);$(text_block).find("tspan").html(update_text)})),element.parent(".material_options").siblings(".mat_value").val(update_text),addSvgToModel.applySvgGraphics()}function textSize(){var element=$(this),text_id=element.attr("data-text-id"),update_font_size=element.val(),textArray=text_id.split(", ");jQuery.each(textArray,(function(i,val){var text_block=document.getElementById(val);$(text_block).find("tspan").removeAttr("font-size"),$(text_block).find("tspan").css("font-size",update_font_size)})),element.siblings(".hidden_font_size").val(update_font_size),addSvgToModel.applySvgGraphics()}function textColor(){var element=$(this),text_id=element.attr("data-text-id"),update_font_color=element.attr("data-text-color"),color_title=element.attr("data-mat-title"),textArray=text_id.split(", ");element.addClass("active").siblings().removeClass("active"),jQuery.each(textArray,(function(i,val){var text_block=document.getElementById(val);$(text_block).find("tspan").attr("fill",update_font_color),$(text_block).find("tspan").css("color",update_font_color)})),element.siblings(".hidden_font_color").val(color_title),addSvgToModel.applySvgGraphics()}function textFamily(){var element=$(this),text_id=element.attr("data-text-id"),update_font_family=element.attr("data-font"),textArray=text_id.split(", ");jQuery.each(textArray,(function(i,val){var text_block=document.getElementById(val);$(text_block).find("tspan").removeAttr("font-family"),$(text_block).find("tspan").css("font-family",update_font_family)})),element.siblings(".hidden_font_family").val(update_font_family),addSvgToModel.applySvgGraphics()}$(".field_text").bind("change paste keyup",textInput),$(".font_size").bind("change",textSize),$(".font_color").bind("click",textColor),$(".fontFamily").bind("click",textFamily)}(),addSvgToModel=function(){var svg_active,mainModel;events.on("ajaxDataReceived",SvgActive),events.on("modelLoaded",setModel),events.on("modelLoaded",applySvgGraphics);var img=new Image;function SvgActive(data){var wc_3d_product_data=jQuery.parseJSON(data);svg_active=wc_3d_product_data.svg_active}function setModel(mainObj){mainModel=mainObj}function applySvgGraphics(mainObj){if("on"==svg_active){var svg=document.getElementById("svg_data").querySelector("svg"),material=document.getElementById("svg_data").getAttribute("data-svgM"),svgData=(new XMLSerializer).serializeToString(svg),src="data:image/svg+xml;base64,"+btoa(svgData);img.onload=function(){mainModel.traverse((function(child){if(child.isMesh){var texture=new THREE.Texture(img),mat=child.material;""!=material?material==mat.name&&(mat.color.set("#ffffff"),mat.map=texture,mat.map.needsUpdate=!0,mat.needsUpdate=!0,mat.side=THREE.DoubleSide):(mat.color.set("#ffffff"),mat.map=texture,mat.map.needsUpdate=!0,mat.needsUpdate=!0,mat.side=THREE.DoubleSide)}}))},img.setAttribute("src",src)}}return{applySvgGraphics:applySvgGraphics}}(),rcActiveDefaultSelection=function(){function ActivateDefault(data){var wc_3d_product_data,svg_active;if("on"==jQuery.parseJSON(data).svg_active){var svg=document.getElementById("svg_data").querySelector("svg");$(".mat_color").each((function(){var element=$(this),selector_id=element.children(".mat_option").first().attr("data-mat");if(selector_id){var matArray=selector_id.split(", ");jQuery.each(matArray,(function(i,val){if(-1!=val.indexOf("*")){var wild_ids=val.replace("*",""),fill_color=$("[id^='"+wild_ids+"']").attr("fill");element.children(".mat_option").each((function(){var color_value=$(this).attr("data-mat-color"),mat_title=$(this).attr("data-mat-title"),mat_price=$(this).attr("data-mat-price");mat_price||(mat_price=0),color_value.toUpperCase()==fill_color?($(this).addClass("active"),element.siblings(".mat_value").val(mat_title),element.siblings(".wc_mat_price").val(mat_price)):$(this).removeClass("active")}))}else{var fill_color=$("#"+val).attr("fill");element.children(".mat_option").each((function(){var color_value=$(this).attr("data-mat-color"),mat_title=$(this).attr("data-mat-title"),mat_price=$(this).attr("data-mat-price");mat_price||(mat_price=0),color_value.toUpperCase()==fill_color?($(this).addClass("active"),element.siblings(".mat_value").val(mat_title),element.siblings(".wc_mat_price").val(mat_price)):$(this).removeClass("active")}))}}))}})),$(".text_color").each((function(){var element=$(this),text_option=element.children(".text_options_block"),selector_id=text_option.children(".font_color").first().attr("data-text-id");if(selector_id){var matArray=selector_id.split(", ");jQuery.each(matArray,(function(i,val){var fill_color=$("#"+val+" tspan").attr("fill");fill_color||(fill_color="#000000"),text_option.children(".font_color").each((function(){var color_value=$(this).attr("data-text-color"),mat_title=$(this).attr("data-mat-title");color_value.toUpperCase()==fill_color?($(this).addClass("active"),element.siblings(".mat_value").val(mat_title)):$(this).removeClass("active")}))}))}}))}}events.on("ajaxDataReceived",ActivateDefault)}(),rcCalculateTotal=function(){var use_price_option;if("yes"==wc3dProductJs.use_price){var iniPrice=$("#finalPrice").val();wc3dcalulatePrice()}function wc3dcalulatePrice(){var matOptionsPrice=0;$(".wc_mat_price").each((function(){var indPrice=$(this).val();matOptionsPrice=parseInt(matOptionsPrice)+parseInt(indPrice)}));var finalPrice=parseInt(iniPrice)+parseInt(matOptionsPrice);$("#finalPrice").val(finalPrice);var cur_symbol=wc3dProductJs.cur_symbol;$(".sub_total").html(cur_symbol+" "+parseFloat(finalPrice).toFixed(2))}return{wc3dcalulatePrice:wc3dcalulatePrice}}(),rcAddtoCart=function(){var isDone=!1,$thisbutton=$(".single_add_to_cart_button"),svg_active;function SvgActive(data){var wc_3d_product_data=jQuery.parseJSON(data);svg_active=wc_3d_product_data.svg_active}function addToCartProcess(e){if(0==isDone){$thisbutton.addClass("loading"),e.preventDefault();var canvas,dataURL=document.getElementById("wc_3d").toDataURL(),svgData;if("on"==svg_active){var svg=document.getElementById("svg_data").querySelector("svg");svgData=(new XMLSerializer).serializeToString(svg)}var action="wc_3d_product_image";jQuery.ajax({type:"POST",url:wc3dProductJs.ajaxUrl,data:{action:action,imgBase64:dataURL},success:function(data){var newdata=JSON.parse(data);$("#wc3dimgurl").val(decodeURIComponent(newdata.url));var action="wc_3d_product_svg";jQuery.ajax({type:"POST",url:wc3dProductJs.ajaxUrl,data:{action:action,svgData:svgData},success:function(data){var newdata=JSON.parse(data),svgurl=decodeURIComponent(newdata.url);$("#wc3dsvgurl").val(svgurl)}}).then((function(){isDone=!0,$(e.currentTarget).trigger("click")}))}})}}events.on("ajaxDataReceived",SvgActive),$($thisbutton).on("click",addToCartProcess)}(),dropzoneUpload=(Dropzone.autoDiscover=!1,void jQuery(".dropzone").dropzone({url:wc3dProductJs.upload,acceptedFiles:".jpg, .png",success:function(file,response){file.previewElement.classList.add("dz-success"),file.previewElement.classList.add("user_image"),file.attachment_id=response,jQuery(file.previewElement).attr("data-attachment",response)},error:function(file,response){file.previewElement.classList.add("dz-error")},addRemoveLinks:!0,removedfile:function(file){var attachment_id=file.attachment_id,_ref;return jQuery.ajax({type:"POST",url:wc3dProductJs.delete,data:{media_id:attachment_id}}),null!=(_ref=file.previewElement)?_ref.parentNode.removeChild(file.previewElement):void 0}})),toDataUrl=function(url,callback){var xhr=new XMLHttpRequest;xhr.onload=function(){var reader=new FileReader;reader.onloadend=function(){callback(reader.result)},reader.readAsDataURL(xhr.response)},xhr.open("GET",url),xhr.responseType="blob",xhr.send()},saveFile=function(strData,filename){var link=document.createElement("a");"string"==typeof link.download?(document.body.appendChild(link),link.download=filename,link.href=strData,link.click(),document.body.removeChild(link)):location.replace(uri)};jQuery(document).ready((function($){jQuery(".wc_3d_materials").accordion({collapsible:!0,header:".material_group h3",autoHeight:!1,heightStyle:"content"})}));